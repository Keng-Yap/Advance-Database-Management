CREATE TABLE Member (
    MemberID CHAR(6) PRIMARY KEY,
    MemberName VARCHAR2(30) NOT NULL,
    MemberEmail VARCHAR2(30),
    MemberPhone VARCHAR2(11) NOT NULL,
    CONSTRAINT chk_Member_Phone CHECK (REGEXP_LIKE(MemberPhone, '^[0-9]{11}$')),
    CONSTRAINT chk_Member_Email CHECK (REGEXP_LIKE(MemberEmail, '^[^@]+@[^@]+\.[^@]+$'))
);

CREATE TABLE Booking (
    BookingID CHAR(6) PRIMARY KEY,
    BookingDate DATE NOT NULL,
    TotalAmount NUMBER(10, 2) DEFAULT 0.0 NOT NULL,
    MemberID CHAR(6) NOT NULL,
    DiscountID CHAR(6),
    FOREIGN KEY (MemberID) REFERENCES Member(MemberID),
    FOREIGN KEY (DiscountID) REFERENCES Discount(DiscountID)
);

CREATE TABLE Discount (
    DiscountID CHAR(6) PRIMARY KEY,
    DiscountCode CHAR(6) NOT NULL,
    DiscountAmount NUMBER(10, 2) DEFAULT 0.0 NOT NULL,
    ExpiryDate DATE NOT NULL
);

CREATE TABLE BookingDetails (
    BookingID CHAR(6) NOT NULL,
    PassengerID CHAR(6) NOT NULL,
    Price NUMBER(10, 2) DEFAULT 0.0 NOT NULL,
    Way VARCHAR2(3) NOT NULL,
    FlightScheduleID CHAR(6),
    SeatID CHAR(3),
    PRIMARY KEY (BookingID, PassengerID),
    FOREIGN KEY (BookingID) REFERENCES Booking(BookingID),
    FOREIGN KEY (FlightScheduleID) REFERENCES FlightSchedule(FlightScheduleID),
    FOREIGN KEY (SeatID) REFERENCES Seat(SeatID),
    FOREIGN KEY (PassengerID) REFERENCES Passenger(PassengerID)
);

CREATE TABLE FlightSchedule (
    FlightScheduleID CHAR(6) PRIMARY KEY,
    FlightDate DATE NOT NULL,
    FlightNumber VARCHAR2(20) NOT NULL,
    DepartureTime TIMESTAMP NOT NULL,
    ArrivalTime TIMESTAMP NOT NULL,
    Origin VARCHAR2(20) NOT NULL,
    Destination VARCHAR2(20) NOT NULL,
    AirplaneID CHAR(6) NOT NULL,
    FOREIGN KEY (AirplaneID) REFERENCES Airplane(AirplaneID)
);

CREATE TABLE Airplane (
    AirplaneID CHAR(6) PRIMARY KEY,
    Model VARCHAR2(10) NOT NULL,
    Capacity NUMBER(3) NOT NULL
);

CREATE TABLE Seat (
    SeatID CHAR(3) PRIMARY KEY,
    SeatNumber VARCHAR2(10) NOT NULL,
    Class VARCHAR2(20) NOT NULL,
    AirplaneID CHAR(6) NOT NULL,
    FOREIGN KEY (AirplaneID) REFERENCES Airplane(AirplaneID)
);

CREATE TABLE Passenger (
    PassengerID CHAR(6) PRIMARY KEY,
    PassengerName VARCHAR2(30) NOT NULL,
    PassportNumber VARCHAR2(20) NOT NULL,
    DOB DATE NOT NULL,
    Gender CHAR(1) NOT NULL
);

CREATE TABLE CheckingLuggage (
    CheckingLuggageID CHAR(6) PRIMARY KEY,
    PassengerID CHAR(6) NOT NULL,
    LuggageID CHAR(6) NOT NULL,
    FOREIGN KEY (PassengerID) REFERENCES Passenger(PassengerID),
    FOREIGN KEY (LuggageID) REFERENCES Luggage(LuggageID)
);

CREATE TABLE Luggage (
    LuggageID CHAR(6) PRIMARY KEY,
    Weight NUMBER(5, 2) NOT NULL
);

CREATE TABLE InsuranceClaim (
    ClaimID CHAR(6) PRIMARY KEY,
    ClaimDate DATE NOT NULL,
    ClaimAmount NUMBER(10, 2) DEFAULT 0.0 NOT NULL,
    PassengerID CHAR(6),
    PolicyID CHAR(6),
    FOREIGN KEY (PassengerID) REFERENCES Passenger(PassengerID),
    FOREIGN KEY (PolicyID) REFERENCES Policy(PolicyID)
);

CREATE TABLE Policy (
    PolicyID CHAR(6) PRIMARY KEY,
    PolicyNumber VARCHAR2(20) NOT NULL,
    CoverageAmount NUMBER(10, 2) DEFAULT 0.0 NOT NULL
);

CREATE TABLE Insurance (
    InsuranceID CHAR(6) PRIMARY KEY,
    InsuranceName VARCHAR2(30) NOT NULL,
    Description CLOB NOT NULL,
    PolicyID CHAR(6),
    FOREIGN KEY (PolicyID) REFERENCES Policy(PolicyID)
);

CREATE TABLE Purchase (
    PurchaseID CHAR(6) PRIMARY KEY,
    Quantity NUMBER(2) NOT NULL,
    ItemID CHAR(6) NOT NULL,
    BookingID CHAR(6) NOT NULL,
    PassengerID CHAR(6) NOT NULL,
    FOREIGN KEY (ItemID) REFERENCES Item(ItemID),
    FOREIGN KEY (BookingID, PassengerID) REFERENCES BookingDetails(BookingID, PassengerID)
);

CREATE TABLE Item (
    ItemID CHAR(6) PRIMARY KEY,
    ItemName VARCHAR2(100) NOT NULL,
    ItemPrice NUMBER(10, 2) DEFAULT 0.0 NOT NULL
);

CREATE TABLE WorkAllocation (
    AllocationID CHAR(6) PRIMARY KEY,
    StaffID CHAR(6) NOT NULL,
    FlightScheduleID CHAR(6) NOT NULL,
    FOREIGN KEY (StaffID) REFERENCES Staff(StaffID),
    FOREIGN KEY (FlightScheduleID) REFERENCES FlightSchedule(FlightScheduleID)
);

CREATE TABLE Staff (
    StaffID CHAR(6) PRIMARY KEY,
    Name VARCHAR2(30) NOT NULL,
    Role VARCHAR2(10) NOT NULL,
    StaffPhone VARCHAR2(11) NOT NULL,
    CONSTRAINT chk_Staff_Phone CHECK (REGEXP_LIKE(StaffPhone, '^[0-9]{11}$'))
);

CREATE TABLE Maintenance (
    MaintenanceID CHAR(6) PRIMARY KEY,
    MaintenanceDate DATE NOT NULL,
    AirplaneID CHAR(6) NOT NULL,
    PartID CHAR(6) NOT NULL,
    FOREIGN KEY (AirplaneID) REFERENCES Airplane(AirplaneID),
    FOREIGN KEY (PartID) REFERENCES Part(PartID)
);

CREATE TABLE Part (
    PartID CHAR(6) PRIMARY KEY,
    PartName VARCHAR2(20) NOT NULL
);

ALTER SESSION SET NLS_DATE_FORMAT='DD-MM-YYYY';
